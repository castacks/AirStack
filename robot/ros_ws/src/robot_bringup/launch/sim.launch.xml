<launch>
  
  <!-- Depth Estimation -->
  <!-- Disparity -->
  <node pkg="stereo_image_proc" exec="disparity_node"
        namespace="stereo_image_proc">
    <remap from="left/image_rect" to="/$(env ROBOT_NAME)/sensors/front_stereo/left/image_rect" />
    <remap from="left/camera_info" to="/$(env ROBOT_NAME)/sensors/front_stereo/left/camera_info" />
    <remap from="right/image_rect" to="/$(env ROBOT_NAME)/sensors/front_stereo/right/image_rect" />
    <remap from="right/camera_info"
           to="/$(env ROBOT_NAME)/sensors/front_stereo/right/camera_info" />

    <remap from="/$(env ROBOT_NAME)/stereo_image_proc/disparity" to="/$(env ROBOT_NAME)/sensors/front_stereo/disparity" />

    <param name="speckle_size" value="300" />
  </node>

  <!-- Visualizer -->
  <!--
      <node pkg="image_view" exec="disparity_view"
      namespace="disparity_view">
      <remap from="image" to="/$(env ROBOT_NAME)/sensors/front_stereo/disparity" />
      </node>
  -->
  <node
      pkg="stereo_image_proc"
      exec="point_cloud_node"
      name="stereo_pointcloud"
      output="screen">
    
    <remap from="left/image_rect_color" to="/$(env ROBOT_NAME)/sensors/front_stereo/left/image_rect"/>
    <remap from="left/camera_info"     to="/$(env ROBOT_NAME)/sensors/front_stereo/left/camera_info"/>
    <remap from="right/camera_info"     to="/$(env ROBOT_NAME)/sensors/front_stereo/right/camera_info"/>
    <remap from="disparity"            to="/$(env ROBOT_NAME)/sensors/front_stereo/disparity"/>
    <remap from="points2"              to="/$(env ROBOT_NAME)/sensors/front_stereo/pointcloud"/>
  </node>

  <!-- GUI -->
  <node pkg="rviz2" exec="rviz2"
	args="-d $(find-pkg-share robot_bringup)/rviz/robot.rviz --ros-args --log-level INFO"
	output="screen" respawn="true" respawn_delay="1" />

  <push-ros-namespace namespace="behavior" />
  <node pkg="rqt_gui" exec="rqt_gui"
	args="--perspective-file $(find-pkg-share robot_bringup)/config/core.perspective">
    <remap from="fixed_trajectory_command"
           to="/$(env ROBOT_NAME)/fixed_trajectory_generator/fixed_trajectory_command" />
  </node>
  
</launch>
